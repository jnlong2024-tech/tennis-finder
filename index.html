<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç½‘çƒåœºåœ°æŸ¥æ‰¾</title>

<!--
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘   ğŸ”‘ ç¬¬ä¸€æ­¥ï¼šæŠŠä¸‹é¢çš„ YOUR_SECURITY_KEY                    â•‘
  â•‘             æ›¿æ¢æˆä½ çš„ã€å®‰å…¨å¯†é’¥ã€‘                           â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
<script>
  window._AMapSecurityConfig = {
    securityJsCode: '	e469d71b1acdcc134ef2e6ca1a94757d',
  }
</script>

<!--
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘   ğŸ”‘ ç¬¬äºŒæ­¥ï¼šæŠŠä¸‹é¢ key= åé¢çš„ YOUR_API_KEY               â•‘
  â•‘             æ›¿æ¢æˆä½ çš„ã€API Keyã€‘                           â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
<script src="https://webapi.amap.com/maps?v=2.0&key=78633132e896679bab70212f1aa966e6&plugin=AMap.PlaceSearch,AMap.Geolocation"></script>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Noto+Sans+SC:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --clay: #C8A882;
    --court-green: #2D5A3D;
    --deep: #1A1A2E;
    --cream: #F5EFE6;
    --white: #FFFFFF;
    --accent: #E8B84B;
    --light-green: #4A7C5F;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Noto Sans SC', sans-serif;
    background: var(--deep);
    color: var(--cream);
    min-height: 100vh;
    overflow-x: hidden;
  }
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      repeating-linear-gradient(0deg, transparent, transparent 40px, rgba(255,255,255,0.015) 40px, rgba(255,255,255,0.015) 41px),
      repeating-linear-gradient(90deg, transparent, transparent 40px, rgba(255,255,255,0.015) 40px, rgba(255,255,255,0.015) 41px);
    pointer-events: none;
    z-index: 0;
  }
  .container { max-width: 900px; margin: 0 auto; padding: 0 20px; position: relative; z-index: 1; }
  header { padding: 50px 0 30px; text-align: center; }
  .logo-line { display: flex; align-items: center; justify-content: center; gap: 16px; margin-bottom: 12px; }
  .logo-icon { width: 48px; height: 48px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; }
  h1 { font-family: 'Playfair Display', serif; font-size: clamp(2rem, 5vw, 3.2rem); color: var(--white); }
  .subtitle { font-size: 0.95rem; color: var(--clay); font-weight: 300; letter-spacing: 2px; text-transform: uppercase; margin-top: 4px; }
  .court-divider { margin: 24px auto; width: 200px; height: 2px; background: linear-gradient(90deg, transparent, var(--court-green), var(--accent), var(--court-green), transparent); }
  .search-panel { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 32px; margin-bottom: 32px; backdrop-filter: blur(10px); }
  .search-row { display: flex; gap: 12px; flex-wrap: wrap; }
  .input-wrap { flex: 1; min-width: 200px; position: relative; }
  .input-wrap input { width: 100%; padding: 14px 20px 14px 48px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; color: var(--white); font-family: 'Noto Sans SC', sans-serif; font-size: 0.95rem; outline: none; transition: all 0.3s; }
  .input-wrap input::placeholder { color: rgba(255,255,255,0.35); }
  .input-wrap input:focus { border-color: var(--accent); background: rgba(255,255,255,0.12); }
  .input-icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); font-size: 18px; pointer-events: none; }
  .btn-locate, .btn-search { padding: 14px 28px; border: none; border-radius: 12px; font-family: 'Noto Sans SC', sans-serif; font-size: 0.95rem; font-weight: 500; cursor: pointer; transition: all 0.25s; white-space: nowrap; }
  .btn-locate { background: var(--court-green); color: var(--white); }
  .btn-locate:hover { background: var(--light-green); transform: translateY(-2px); }
  .btn-search { background: var(--accent); color: var(--deep); }
  .btn-search:hover { background: #f0cc6a; transform: translateY(-2px); }
  .status-bar { text-align: center; padding: 12px; font-size: 0.85rem; color: var(--clay); min-height: 40px; transition: all 0.3s; }
  .status-bar.loading { color: var(--accent); }
  .status-bar.error { color: #E87070; }
  .status-bar.success { color: #7DC897; }
  #mapContainer { width: 100%; height: 300px; border-radius: 16px; overflow: hidden; margin-bottom: 32px; border: 1px solid rgba(255,255,255,0.08); }
  .filter-row { display: flex; gap: 10px; margin-bottom: 24px; flex-wrap: wrap; }
  .filter-btn { padding: 8px 18px; border-radius: 100px; border: 1px solid rgba(255,255,255,0.15); background: transparent; color: rgba(255,255,255,0.6); font-family: 'Noto Sans SC', sans-serif; font-size: 0.82rem; cursor: pointer; transition: all 0.2s; }
  .filter-btn.active, .filter-btn:hover { background: var(--court-green); border-color: var(--court-green); color: var(--white); }
  .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
  .results-count { font-size: 0.85rem; color: var(--clay); }
  .results-count strong { color: var(--accent); font-size: 1.1rem; }
  .court-card { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); border-radius: 16px; padding: 24px; margin-bottom: 16px; display: grid; grid-template-columns: auto 1fr auto; gap: 20px; align-items: start; transition: all 0.3s; animation: slideIn 0.4s ease backwards; }
  .court-card:hover { background: rgba(255,255,255,0.08); border-color: rgba(200,168,130,0.3); transform: translateX(4px); }
  @keyframes slideIn { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
  .court-rank { width: 40px; height: 40px; background: linear-gradient(135deg, var(--court-green), var(--light-green)); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-family: 'Playfair Display', serif; font-size: 1.1rem; color: var(--white); flex-shrink: 0; }
  .court-info h3 { font-size: 1.05rem; font-weight: 500; color: var(--white); margin-bottom: 6px; }
  .court-addr { font-size: 0.82rem; color: rgba(255,255,255,0.45); margin-bottom: 10px; line-height: 1.5; }
  .court-tags { display: flex; gap: 8px; flex-wrap: wrap; }
  .tag { padding: 3px 10px; border-radius: 100px; font-size: 0.75rem; font-weight: 300; }
  .tag-type { background: rgba(200,168,130,0.15); color: var(--clay); border: 1px solid rgba(200,168,130,0.2); }
  .tag-tel { background: rgba(74,124,95,0.2); color: #7DC897; border: 1px solid rgba(74,124,95,0.3); }
  .court-meta { text-align: right; flex-shrink: 0; }
  .distance { font-size: 1.1rem; font-weight: 500; color: var(--accent); margin-bottom: 4px; }
  .rating { font-size: 0.8rem; color: rgba(255,255,255,0.4); }
  .stars { color: var(--accent); }
  .btn-nav { display: inline-block; margin-top: 8px; padding: 5px 12px; background: rgba(232,184,75,0.15); border: 1px solid rgba(232,184,75,0.3); border-radius: 8px; color: var(--accent); font-size: 0.75rem; cursor: pointer; transition: all 0.2s; }
  .btn-nav:hover { background: rgba(232,184,75,0.25); }
  .empty-state { text-align: center; padding: 60px 20px; color: rgba(255,255,255,0.25); }
  .empty-state .emoji { font-size: 48px; margin-bottom: 16px; }
  .empty-state p { font-size: 0.9rem; line-height: 1.8; }
  footer { text-align: center; padding: 40px 0; font-size: 0.78rem; color: rgba(255,255,255,0.2); }
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="logo-line">
      <div class="logo-icon">ğŸ¾</div>
      <h1>ç½‘çƒåœºåœ°æœç´¢</h1>
    </div>
    <p class="subtitle">TENNIS COURT FINDER</p>
    <div class="court-divider"></div>
  </header>

  <div class="search-panel">
    <div class="search-row">
      <div class="input-wrap">
        <span class="input-icon">ğŸ“</span>
        <input type="text" id="locationInput" placeholder="è¾“å…¥åŸå¸‚æˆ–åœ°åŒºï¼Œä¾‹å¦‚ï¼šåŒ—äº¬æœé˜³åŒº" />
      </div>
      <button class="btn-locate" onclick="getMyLocation()">ğŸ“¡ å®šä½æˆ‘çš„ä½ç½®</button>
      <button class="btn-search" onclick="searchByCity()">æœç´¢åœºåœ°</button>
    </div>
    <div class="status-bar" id="statusBar">è¯·è¾“å…¥åœ°å€æˆ–ç‚¹å‡»"å®šä½æˆ‘çš„ä½ç½®"å¼€å§‹æœç´¢</div>
  </div>

  <div id="mapContainer"></div>

  <div class="filter-row" id="filterRow" style="display:none">
    <button class="filter-btn active" onclick="filterCourts('all', this)">å…¨éƒ¨</button>
    <button class="filter-btn" onclick="filterCourts('å®¤å†…', this)">ğŸ  å®¤å†…åœº</button>
    <button class="filter-btn" onclick="filterCourts('å®¤å¤–', this)">â˜€ï¸ å®¤å¤–åœº</button>
    <button class="filter-btn" onclick="filterCourts('ä¿±ä¹éƒ¨', this)">ğŸ† ä¿±ä¹éƒ¨</button>
    <button class="filter-btn" onclick="filterCourts('å…¬å›­', this)">ğŸŒ³ å…¬å…±åœºåœ°</button>
  </div>

  <div id="resultsSection">
    <div class="empty-state">
      <div class="emoji">ğŸ¾</div>
      <p>ç‚¹å‡»"å®šä½æˆ‘çš„ä½ç½®"<br>æˆ–è¾“å…¥åœ°å€åæœç´¢<br>å³å¯æ‰¾åˆ°é™„è¿‘çœŸå®çš„ç½‘çƒåœºåœ°</p>
    </div>
  </div>

  <footer>Tennis Court Finder Â· æ•°æ®æ¥æºï¼šé«˜å¾·åœ°å›¾</footer>
</div>

<script>
let map = null, allCourts = [], markers = [];

function setStatus(msg, type) {
  const el = document.getElementById('statusBar');
  el.className = 'status-bar ' + (type || '');
  el.textContent = msg;
}

function initMap(center) {
  if (map) { map.setCenter(center); return; }
  map = new AMap.Map('mapContainer', { zoom: 13, center: center, mapStyle: 'amap://styles/dark' });
  new AMap.Marker({
    position: center, map: map,
    content: '<div style="background:#E8B84B;width:14px;height:14px;border-radius:50%;border:3px solid white;box-shadow:0 0 0 6px rgba(232,184,75,0.3)"></div>',
    offset: new AMap.Pixel(-7, -7)
  });
}

function clearMarkers() { markers.forEach(m => m.setMap(null)); markers = []; }

function getMyLocation() {
  setStatus('ğŸ“¡ æ­£åœ¨è·å–æ‚¨çš„ä½ç½®...', 'loading');
  AMap.plugin('AMap.Geolocation', function() {
    const geo = new AMap.Geolocation({ enableHighAccuracy: true, timeout: 10000 });
    geo.getCurrentPosition(function(err, result) {
      if (err) { setStatus('âŒ å®šä½å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è¾“å…¥åŸå¸‚åæœç´¢', 'error'); return; }
      const lng = result.position.getLng(), lat = result.position.getLat();
      const city = result.addressComponent.city || result.addressComponent.province;
      document.getElementById('locationInput').value = city;
      setStatus('âœ… å®šä½æˆåŠŸï¼š' + city, 'success');
      initMap([lng, lat]);
      doSearch(null, [lng, lat], 5000);
    });
  });
}

function searchByCity() {
  const city = document.getElementById('locationInput').value.trim();
  if (!city) { setStatus('âš ï¸ è¯·å…ˆè¾“å…¥åŸå¸‚æˆ–åœ°å€', 'error'); return; }
  setStatus('ğŸ” æ­£åœ¨æœç´¢"' + city + '"é™„è¿‘çš„ç½‘çƒåœºåœ°...', 'loading');
  doSearch(city, null, null);
}

function doSearch(city, location, radius) {
  AMap.plugin('AMap.PlaceSearch', function() {
    const opts = { pageSize: 20, pageIndex: 1 };
    if (city) opts.city = city;
    const ps = new AMap.PlaceSearch(opts);

    const callback = function(status, result) {
      if (status === 'complete' && result.poiList && result.poiList.pois.length > 0) {
        const pois = result.poiList.pois;
        const first = pois[0].location;
        if (first) initMap([first.getLng(), first.getLat()]);
        showResults(pois);
      } else {
        setStatus('âŒ æœªæ‰¾åˆ°ç›¸å…³åœºåœ°ï¼Œè¯·å°è¯•å…¶ä»–åŸå¸‚åç§°', 'error');
      }
    };

    if (location) {
      ps.searchNearBy('ç½‘çƒåœº', location, radius, callback);
    } else {
      ps.search('ç½‘çƒåœº', callback);
    }
  });
}

function showResults(pois) {
  allCourts = pois;
  setStatus('âœ… æ‰¾åˆ° ' + pois.length + ' ä¸ªç½‘çƒåœºåœ°', 'success');
  document.getElementById('filterRow').style.display = 'flex';
  renderCourts(pois);
  addMapMarkers(pois);
}

function renderCourts(pois) {
  const section = document.getElementById('resultsSection');
  if (!pois || pois.length === 0) {
    section.innerHTML = '<div class="empty-state"><div class="emoji">ğŸ”</div><p>å½“å‰ç­›é€‰ä¸‹æš‚æ— åœºåœ°</p></div>';
    return;
  }
  section.innerHTML = `
    <div class="results-header"><div class="results-count">å…±æ‰¾åˆ° <strong>${pois.length}</strong> ä¸ªåœºåœ°</div></div>
    ${pois.map((poi, i) => {
      const dist = poi.distance ? (poi.distance >= 1000 ? (poi.distance/1000).toFixed(1)+'km' : poi.distance+'m') : 'â€”';
      const tel = poi.tel ? `<span class="tag tag-tel">ğŸ“ ${poi.tel}</span>` : '';
      const type = poi.type ? `<span class="tag tag-type">${poi.type.split(';')[0]}</span>` : '';
      const rating = poi.biz_ext && poi.biz_ext.rating ? poi.biz_ext.rating : 'â€”';
      const lng = poi.location ? poi.location.getLng() : null;
      const lat = poi.location ? poi.location.getLat() : null;
      const navBtn = lng ? `<div class="btn-nav" onclick="navigate(${lng},${lat},'${poi.name.replace(/'/g,'')}')">ğŸ—º å¯¼èˆª</div>` : '';
      return `
        <div class="court-card" style="animation-delay:${i*0.06}s">
          <div class="court-rank">${i+1}</div>
          <div class="court-info">
            <h3>${poi.name}</h3>
            <div class="court-addr">ğŸ“ ${poi.address || 'åœ°å€æœªçŸ¥'}</div>
            <div class="court-tags">${type}${tel}</div>
          </div>
          <div class="court-meta">
            <div class="distance">${dist}</div>
            <div class="rating"><span class="stars">â˜…</span> ${rating}</div>
            ${navBtn}
          </div>
        </div>`;
    }).join('')}`;
}

function addMapMarkers(pois) {
  if (!map) return;
  clearMarkers();
  pois.forEach(poi => {
    if (!poi.location) return;
    const m = new AMap.Marker({
      position: [poi.location.getLng(), poi.location.getLat()],
      map: map,
      label: { content: `<div style="background:#2D5A3D;color:white;padding:2px 8px;border-radius:6px;font-size:12px;white-space:nowrap">${poi.name}</div>`, offset: new AMap.Pixel(0, -30) }
    });
    markers.push(m);
  });
  map.setFitView();
}

function filterCourts(keyword, btn) {
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  const filtered = keyword === 'all' ? allCourts : allCourts.filter(p => (p.name+(p.type||'')+(p.address||'')).includes(keyword));
  renderCourts(filtered);
  addMapMarkers(filtered);
}

function navigate(lng, lat, name) {
  window.open(`https://uri.amap.com/navigation?to=${lng},${lat},${encodeURIComponent(name)}&mode=car&src=myapp&coordinate=gaode&callnative=1`, '_blank');
}

document.getElementById('locationInput').addEventListener('keydown', e => { if (e.key === 'Enter') searchByCity(); });
</script>
</body>
</html>
